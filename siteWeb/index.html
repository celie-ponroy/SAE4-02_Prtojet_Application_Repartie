<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <link rel="stylesheet" href="css/style.css">
    <title>Projet Application Répartie</title>
</head>

<body>
    <div class="sidebar">
        <button onclick="showTab('accueil')">Accueil</button>
        <button onclick="showTab('compteRendu')">Compte rendu</button>
    </div>
    <div class="main-content" id="mainContent">
        <!-- Barre de météo -->
        <div id="meteoInfo" class="meteo-info-bar">
            <div class="meteo-header">
                <h2>Météo</h2>
            </div>
            <div class="meteo-content">
            </div>
        </div>

        <!-- Contenu des onglets -->
        <div id="accueil" class="tab-content" style="display: block;">
            <div id="map"></div>
            <div id="stationInfo"></div>
        </div>
        <div id="compteRendu" class="tab-content" style="display: none;">
            <h2>Compte rendu</h2>
            <p>Contenu du compte rendu...
                A completer
            </p>
        </div>
    </div>

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin="" defer></script>

    <!-- Template pour les stations de velo -->
    <script id="stationTemplate" type="text/x-handlebars-template">
        <h2>Stations Vlib: </h2>
        <div>
            <h4>{{this.name}} :</h4>
            <div>
                <img src="img/bike.svg" alt="vélo" height="15" width="15"/>
                {{this.nbVelo}}
                <img src="img/parking.svg" alt="docks" height="15" width="15"/>
                {{this.nbDock}}
            </div>
            <div><p>Adresse : {{this.address}}</p></div>
        </div>
    </script>

    <!-- Template pour la météo -->
    <script id="meteoTemplate" type="text/x-handlebars-template">
        {{#each temperatures}}
            <div class="meteo-item">
                <p><strong>{{time}}</strong></p>
                <img src="{{icon}}" alt="icon" height="25" width="25"/>
                <p>{{temperature}} °C</p>
            </div>
        {{/each}}
    </script>

    <script>
        function showTab(tabId) {
            var tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.style.display = 'none');
            document.getElementById(tabId).style.display = 'block';

            // Si la carte est visible, redimensionner la carte pour s'adapter au conteneur
            if (tabId === 'accueil') {
                setTimeout(() => {
                    if (window.map) {
                        window.map.invalidateSize();
                    }
                }, 100); // Timeout pour attendre la fin du rendu
            }
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
    <script src="js/index.js" type="module"></script>
</body>
</html>
